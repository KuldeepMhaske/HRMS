@using Microsoft.AspNetCore.Mvc.Rendering
@{
    ViewData["Title"] = "Leaves";

    int month = ViewBag.SelectedMonth;
    int year = ViewBag.SelectedYear;

    int daysInMonth = DateTime.DaysInMonth(year, month);

    // Monday = 0, Sunday = 6
    int startDay = (int)new DateTime(year, month, 1).DayOfWeek;
    startDay = startDay == 0 ? 6 : startDay - 1;

    int day = 1;
}

<div class="container-fluid mt-3">

    <!-- PAGE TITLE -->
    <h4 class="mb-3">🌴 Leaves Calendar</h4>

    <!-- MONTH NAVIGATION -->
    <div class="d-flex justify-content-between align-items-center mb-3">

        <!-- PREVIOUS MONTH -->
        <a class="btn btn-outline-secondary"
           asp-action="Index"
           asp-route-month="@(month == 1 ? 12 : month - 1)"
           asp-route-year="@(month == 1 ? year - 1 : year)">
            ⬅️
        </a>

        <!-- MONTH + YEAR SELECT -->
        <form method="get" class="d-flex gap-2">
            <select name="month"
                    class="form-select"
                    style="width:160px"
                    onchange="this.form.submit()">
                @foreach (SelectListItem m in ViewBag.Months)
                {
                    <option value="@m.Value" selected="@m.Selected">@m.Text</option>
                }
            </select>

            <select name="year"
                    class="form-select"
                    style="width:110px"
                    onchange="this.form.submit()">
                @foreach (SelectListItem y in ViewBag.Years)
                {
                    <option value="@y.Value" selected="@y.Selected">@y.Text</option>
                }
            </select>
        </form>

        <!-- NEXT MONTH -->
        <a class="btn btn-outline-secondary"
           asp-action="Index"
           asp-route-month="@(month == 12 ? 1 : month + 1)"
           asp-route-year="@(month == 12 ? year + 1 : year)">
            ➡️
        </a>
    </div>

    <!-- MONTH TITLE -->
    <h5 class="text-center fw-bold mb-2">
         @(new DateTime(year, month, 1).ToString("MMMM yyyy"))
    </h5>


    <!-- CALENDAR -->
    <div class="table-responsive">
        <table class="table table-bordered text-center align-middle shadow-sm">

            <thead class="table-primary">
                <tr>
                    <th>Monday</th>
                    <th>Tuesday</th>
                    <th>Wednesday</th>
                    <th>Thursday</th>
                    <th>Friday</th>
                    <th class="bg-danger">Saturday</th>
                    <th class="bg-danger">Sunday</th>
                </tr>
            </thead>

            <tbody>
                @for (int row = 0; row < 6; row++)
                {
                    <tr>
                        @for (int col = 0; col < 7; col++)
                        {
                            if ((row == 0 && col < startDay) || day > daysInMonth)
                            {
                                <td class="bg-light"></td>
                            }
                            else
                            {
                                <td style="height:90px; vertical-align:top;">
                                    <div class="fw-semibold">@day</div>

                                    <!-- PLACEHOLDER (Phase-2 logic will come here) -->
                                    <span class="badge bg-secondary mt-1">
                                        --
                                    </span>

                                </td>
                                day++;
                            }
                        }
                    </tr>
                }
            </tbody>

        </table>
    </div>

</div>
