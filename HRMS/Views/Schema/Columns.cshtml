@model List<HRMS.Controllers.ColumnInfo>

<h2>Columns - @ViewBag.TableName</h2>

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">@TempData["Error"]</div>
}
@if (TempData["Success"] != null)
{
    <div class="alert alert-success">@TempData["Success"]</div>
}

<a asp-action="AddColumn"
   asp-route-tableName="@ViewBag.TableName"
   class="btn btn-primary mb-3">
    ➕ Add Column
</a>

<table class="table table-striped">
    <thead>
        <tr>
            <th>Name</th>
            <th>Type</th>
            <th>Nullable</th>
            <th style="width:120px;">Action</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var col in Model)
        {
            <tr>
                <td>@col.COLUMN_NAME</td>
                <td>@col.DATA_TYPE</td>
                <td>@col.IS_NULLABLE</td>
                <td>
                    @if (!col.COLUMN_NAME.Equals("Id", StringComparison.OrdinalIgnoreCase))
                    {
                        <form asp-action="DeleteColumn"
                              method="post"
                              onsubmit="return confirm('Are you sure you want to permanently delete this column?');"
                              style="display:inline;">
                            @Html.AntiForgeryToken()

                            <input type="hidden" name="tableName" value="@ViewBag.TableName" />
                            <input type="hidden" name="columnName" value="@col.COLUMN_NAME" />

                            <button class="btn btn-sm btn-danger">
                                🗑 Delete
                            </button>
                        </form>
                    }
                    else
                    {
                        <span class="text-muted">Locked</span>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>
